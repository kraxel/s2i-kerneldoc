#!/bin/bash -e
#
# For more information refer to the documentation:
#	https://github.com/openshift/source-to-image/blob/master/docs/builder_image.md
#

source ${0}.pre

echo "---> Installing application source ..."
rm -rf /tmp/src/.git
mv  /tmp/src ./linux

echo "---> Building kerneldoc ..."
make PYTHON=/usr/bin/python3 -C linux htmldocs

echo "---> Move docs output and cleanup ..."
mv linux/Documentation/output .
rm -rf linux

echo "---> Fix permissions ..."
find -type f -print0 | xargs -0 chmod +r
find -type d -print0 | xargs -0 chmod +r
find -type d -print0 | xargs -0 chmod +x
